<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>The swiftclient.SwiftService API &#8212; python-swiftclient 0.1.0.dev1151 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fe63c2af" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=5c69cfe2" />
    <script src="_static/documentation_options.js?v=2f6af510"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The swiftclient.Connection API" href="client-api.html" />
    <link rel="prev" title="CLI" href="cli/index.html" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Bootstrap CSS -->
<link href="_static/css/bootstrap.min.css" rel="stylesheet">

<!-- Fonts -->
<link href="_static/css/font-awesome.min.css" rel="stylesheet">

<!-- Custom CSS -->
<link href="_static/css/combined.css" rel="stylesheet">

<!-- Search CSS -->
<link href="_static/css/search.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="_static/pygments.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->


  </head><body>

<!-- SOURCE_FILE: https://opendev.org/openstack/python-swiftclient/src/doc/source/service-api.rst -->

<script>
    (function (window, document) {
        var loader = function () {
            var script = document.createElement("script"), tag = document.getElementsByTagName("script")[0];
            script.src = "https://search.openstack.org/widget/embed.min.js?t="+Date.now();
            tag.parentNode.insertBefore(script, tag);
        };
        window.addEventListener ? window.addEventListener("load", loader, false) : window.attachEvent("onload", loader);
    })(window, document);
</script>

<nav class="navbar navbar-default navbar-expand-md" role="navigation">
  <div class="container">
    <!-- Brand and toggle get grouped for better mobile display -->
      <div class="brand-wrapper">
        <a class="navbar-brand" href="https://www.openstack.org/">
        <img src="_static/images/logo-full.svg" width="135px" height="35px"/>
        </a>
      </div>
      <button class="navbar-toggler" data-bs-target="#navbar-main-1" aria-controls="navbar-main-1" data-bs-toggle="collapse" type="button">
        <span class="navbar-toggler-icon"></span>
        <span class="sr-only">Toggle navigation</span>
      </button>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div>
      <div class="collapse navbar-collapse" id="navbar-main-1">
<div class="search-container tiny">
    <div class="openstack-search-bar" data-baseUrl="search.openstack.org" data-context="docs-openstack"></div>
</div>
      <ul class="nav navbar-nav navbar-main ms-auto mb-2 mb-lg-0 justify-content-end show" role="navigation">
<li class="search-container-mobile">
    <div class="openstack-search-bar" data-baseUrl="search.openstack.org" data-context="docs-openstack"></div>
</li>
        <li class="nav-item dropdown"> <!--Software -->
          <a href="https://www.openstack.org/software/" class="nav-link dropdown-toggle" aria-expanded="false">Software</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="https://www.openstack.org/software/">Overview</a></li>
            <li><a class="dropdown-item" href="https://www.openstack.org/software/project-navigator/openstack-components">OpenStack Components</a></li>
            <li><a class="dropdown-item" href="https://www.openstack.org/software/project-navigator/sdks">SDKs</a></li>
            <li><a class="dropdown-item" href="https://www.openstack.org/software/project-navigator/deployment-tools">Deployment Tools</a></li>
            <li><a class="dropdown-item" href="https://www.openstack.org/assets/software/projectmap/openstack-map.pdf" target="_blank">OpenStack Map</a></li>
            <li><a class="dropdown-item" href="https://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
          </ul>
        </li>
        <li class="nav-item drop-down"> <!-- Use Cases -->
          <a href="https://www.openstack.org/use-cases/" class="nav-link dropdown-toggle" role="button">Use Cases</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="https://www.openstack.org/use-cases/">Users in Production</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="https://www.openstack.org/use-cases/bare-metal/">Ironic Bare Metal</a></li>
            <li><a class="dropdown-item" href="https://www.openstack.org/use-cases/edge-computing/">Edge Computing</a></li>
            <li><a class="dropdown-item" href="https://www.openstack.org/use-cases/telecoms-and-nfv/">Telecom &amp; NFV</a></li>
            <li><a class="dropdown-item" href="https://www.openstack.org/use-cases/science/">Science and HPC</a></li>
            <li><a class="dropdown-item" href="https://www.openstack.org/use-cases/containers/">Containers</a></li>
            <li><a class="dropdown-item" href="https://www.openstack.org/use-cases/enterprise/">Enterprise</a></li>
            <li><a class="dropdown-item" href="https://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li class="nav-item dropdown"> <!-- Events -->
          <a href="https://openinfra.dev/summit" class="nav-link dropdown-toggle" role="button" id="dropdownMenuEvents">Events</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="https://openinfra.dev/summit">OpenInfra Summit</a></li>
            <li><a class="dropdown-item" href="https://www.openstack.org/ptg/">Project Teams Gathering</a></li>
            <li><a class="dropdown-item" href="https://www.openstack.org/events/opendev-2020/">OpenDev</a></li>
            <li><a class="dropdown-item" href="https://www.openstack.org/events/community-events/">Community Events</a></li>
            <li><a class="dropdown-item" href="https://www.openstack.org/events/openstackdays">OpenStack &amp; OpenInfra Days</a></li>
            <li><a class="dropdown-item" href="https://www.openstack.org/videos/">Summit Videos</a></li>
          </ul>
        </li>
        <li class="nav-item dropdown"><!-- Community -->
          <a href="https://www.openstack.org/community/" class="nav-link dropdown-toggle" role="button">Community</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="https://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li><a class="dropdown-item" href="https://www.openstack.org/community/tech-committee">OpenStack Technical Committee</a></li>
            <li><a class="dropdown-item" href="https://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li><a class="dropdown-item" href="http://wiki.openstack.org">OpenStack Wiki</a></li>
            <li><a class="dropdown-item" href="https://www.openstack.org/coa/">Get Certified (COA)</a></li>
            <li><a class="dropdown-item" href="https://www.openstack.org/community/jobs/">Jobs</a></li>
            <li><a class="dropdown-item" href="https://www.openstack.org/marketing/">Marketing Resources</a></li>
            <li><a class="dropdown-item" href="https://www.openstack.org/news/">Community News</a></li>
            <li><a class="dropdown-item" href="http://superuser.openstack.org">Superuser Magazine</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="https://www.openstack.org/community/supporting-organizations/">OpenInfra Foundation Supporting Organizations</a></li>
            <li><a class="dropdown-item" href="https://openinfra.dev">OpenInfra Foundation</a></li>
          </ul>
        </li>
        <li class="nav-item dropdown"><!-- Marketplace -->
          <a href="https://www.openstack.org/marketplace/" class="nav-link dropdown-toggle" role="button">Marketplace</a>
          <ul class="dropdown-menu dropdown-hover">
            <li><a class="dropdown-item" href="https://www.openstack.org/marketplace/training/">Training</a></li>
            <li><a class="dropdown-item" href="https://www.openstack.org/marketplace/distros/">Distros &amp; Appliances</a></li>
            <li><a class="dropdown-item" href="https://www.openstack.org/marketplace/public-clouds/">Public Clouds</a></li>
            <li><a class="dropdown-item" href="https://www.openstack.org/marketplace/hosted-private-clouds/">Hosted Private Clouds</a></li>
            <li><a class="dropdown-item" href="https://www.openstack.org/marketplace/remotely-managed-private-clouds/">Remotely Managed Private Clouds</a></li>
            <li><a class="dropdown-item" href="https://www.openstack.org/marketplace/consulting/">Consulting &amp; Integrators</a></li>
            <li><a class="dropdown-item" href="https://www.openstack.org/marketplace/drivers/">Drivers</a></li>
          </ul>
        </li>
        <li class="nav-item"><!-- Blog -->
          <a class="nav-link" href="https://www.openstack.org/blog/">Blog</a>
        </li>
        <li class="nav-item"><!-- Docs -->
          <a class="nav-link" href="http://docs.openstack.org/">Docs</a>
        </li>
        <li class="nav-item dropdown join-nav-section"> <!-- Join -->
          <a href="https://openinfra.dev/join/" class="nav-link dropdown-toggle" role="button">Join</a>
          <ul class="dropdown-menu" style="display: none;">
            <li><a class="dropdown-item" href="https://openinfra.dev/join/">Sign up for Foundation Membership</a></li>
            <li><a class="dropdown-item" href="https://openinfra.dev/join/">Sponsor the Foundation</a></li>
            <li><a class="dropdown-item" href="https://openinfra.dev">More about the Foundation</a></li>
          </ul>
        </li>
        <li class="nav-item"> <!-- Login -->
          <a href="https://www.openstack.org/Security/login/?BackURL=/home/" class="sign-in-btn">Log In</a>
        </li>
      </ul>
    </div>
  </div>
  <!-- /.container -->
</nav>

    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4 order-4">
<div class="row docs-title">
  <div class="col-lg-8">
      <h1>The swiftclient.SwiftService API</h1>
    
  </div>
  <div class="docs-actions">
      <div class="version-dropdown">
        <span>version</span>
        <div class="version-dropdown-content">
            <p><a href="../latest" rel="nofollow">latest</a></p>
        </div>
      </div>
    
    <a href="cli/index.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: CLI"></i></a>
    
    
    <a href="client-api.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: The swiftclient.Connection API"></i></a>
    
    <a id="pdfLink1" href="" target="_blank" title="Download the manuals as PDF"><i class="fa fa-file-pdf-o" data-toggle="tooltip" data-placement="top" title="Download PDF"></i></a>
    
    <a id="logABugLink1" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
    
  </div>
</div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-body" role="main">

  <section id="the-swiftclient-swiftservice-api">
<h1>The swiftclient.SwiftService API<a class="headerlink" href="#the-swiftclient-swiftservice-api" title="Link to this heading">¶</a></h1>
<p>A higher-level API aimed at allowing developers an easy way to perform multiple
operations asynchronously using a configurable thread pool. Documentation for
each service method call can be found here: <a class="reference internal" href="swiftclient.html#module-swiftclient.service" title="swiftclient.service"><code class="xref py py-mod docutils literal notranslate"><span class="pre">swiftclient.service</span></code></a>.</p>
<section id="authentication">
<h2>Authentication<a class="headerlink" href="#authentication" title="Link to this heading">¶</a></h2>
<p>This section covers the various options for authenticating with a swift
object store. The combinations of options required for each authentication
version are detailed below. Once again, these are just a subset of those that
can be used to successfully authenticate, but they are the most common and
recommended.</p>
<p>The relevant authentication options are presented as python dictionaries that
should be added to any other options you are supplying to your <code class="docutils literal notranslate"><span class="pre">SwiftService</span></code>
instance. As indicated in the python code, you can also set these options as
environment variables that will be loaded automatically if the relevant option
is not specified.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">SwiftService</span></code> authentication attempts to automatically select
the auth version based on the combination of options specified, but
supplying options from multiple different auth versions can cause unexpected
behaviour.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Leftover environment variables are a common source of confusion when
authorization fails.</p>
</div>
<section id="keystone-v3">
<h3>Keystone V3<a class="headerlink" href="#keystone-v3" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="o">...</span>
    <span class="s2">&quot;auth_version&quot;</span><span class="p">:</span> <span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ST_AUTH_VERSION&#39;</span><span class="p">),</span>  <span class="c1"># Should be &#39;3&#39;</span>
    <span class="s2">&quot;os_username&quot;</span><span class="p">:</span> <span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;OS_USERNAME&#39;</span><span class="p">),</span>
    <span class="s2">&quot;os_password&quot;</span><span class="p">:</span> <span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;OS_PASSWORD&#39;</span><span class="p">),</span>
    <span class="s2">&quot;os_project_name&quot;</span><span class="p">:</span> <span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;OS_PROJECT_NAME&#39;</span><span class="p">),</span>
    <span class="s2">&quot;os_project_domain_name&quot;</span><span class="p">:</span> <span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;OS_PROJECT_DOMAIN_NAME&#39;</span><span class="p">),</span>
    <span class="s2">&quot;os_auth_url&quot;</span><span class="p">:</span> <span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;OS_AUTH_URL&#39;</span><span class="p">),</span>
    <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="o">...</span>
    <span class="s2">&quot;auth_version&quot;</span><span class="p">:</span> <span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ST_AUTH_VERSION&#39;</span><span class="p">),</span>  <span class="c1"># Should be &#39;3&#39;</span>
    <span class="s2">&quot;os_username&quot;</span><span class="p">:</span> <span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;OS_USERNAME&#39;</span><span class="p">),</span>
    <span class="s2">&quot;os_password&quot;</span><span class="p">:</span> <span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;OS_PASSWORD&#39;</span><span class="p">),</span>
    <span class="s2">&quot;os_project_id&quot;</span><span class="p">:</span> <span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;OS_PROJECT_ID&#39;</span><span class="p">),</span>
    <span class="s2">&quot;os_project_domain_id&quot;</span><span class="p">:</span> <span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;OS_PROJECT_DOMAIN_ID&#39;</span><span class="p">),</span>
    <span class="s2">&quot;os_auth_url&quot;</span><span class="p">:</span> <span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;OS_AUTH_URL&#39;</span><span class="p">),</span>
    <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="keystone-v2">
<h3>Keystone V2<a class="headerlink" href="#keystone-v2" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="o">...</span>
    <span class="s2">&quot;auth_version&quot;</span><span class="p">:</span> <span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ST_AUTH_VERSION&#39;</span><span class="p">),</span>  <span class="c1"># Should be &#39;2.0&#39;</span>
    <span class="s2">&quot;os_username&quot;</span><span class="p">:</span> <span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;OS_USERNAME&#39;</span><span class="p">),</span>
    <span class="s2">&quot;os_password&quot;</span><span class="p">:</span> <span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;OS_PASSWORD&#39;</span><span class="p">),</span>
    <span class="s2">&quot;os_tenant_name&quot;</span><span class="p">:</span> <span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;OS_TENANT_NAME&#39;</span><span class="p">),</span>
    <span class="s2">&quot;os_auth_url&quot;</span><span class="p">:</span> <span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;OS_AUTH_URL&#39;</span><span class="p">),</span>
    <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="legacy-auth">
<h3>Legacy Auth<a class="headerlink" href="#legacy-auth" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="o">...</span>
    <span class="s2">&quot;auth_version&quot;</span><span class="p">:</span> <span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ST_AUTH_VERSION&#39;</span><span class="p">),</span>  <span class="c1"># Should be &#39;1.0&#39;</span>
    <span class="s2">&quot;auth&quot;</span><span class="p">:</span> <span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ST_AUTH&#39;</span><span class="p">),</span>
    <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ST_USER&#39;</span><span class="p">),</span>
    <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ST_KEY&#39;</span><span class="p">),</span>
    <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Link to this heading">¶</a></h2>
<p>When you create an instance of a <code class="docutils literal notranslate"><span class="pre">SwiftService</span></code>, you can override a collection
of default options to suit your use case. Typically, the defaults are sensible to
get us started, but depending on your needs you might want to tweak them to
improve performance (options affecting large objects and thread counts can
significantly alter performance in the right situation).</p>
<p>Service level defaults and some extra options can also be overridden on a
per-operation (or even in some cases per-object) basis, and you will call out
which options affect which operations later in the document.</p>
<p>The configuration of the service API is performed using an options dictionary
passed to the <code class="docutils literal notranslate"><span class="pre">SwiftService</span></code> during initialisation. The options available
in this dictionary are described below, along with their defaults:</p>
<section id="options">
<h3>Options<a class="headerlink" href="#options" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">retries</span></code>: <code class="docutils literal notranslate"><span class="pre">5</span></code></dt><dd><p>The number of times that the library should attempt to retry HTTP
actions before giving up and reporting a failure.</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">container_threads</span></code>: <code class="docutils literal notranslate"><span class="pre">10</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">object_dd_threads</span></code>: <code class="docutils literal notranslate"><span class="pre">10</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">object_uu_threads</span></code>: <code class="docutils literal notranslate"><span class="pre">10</span></code></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">segment_threads</span></code>: <code class="docutils literal notranslate"><span class="pre">10</span></code></dt><dd><p>The above options determine the size of the available thread pools for
performing swift operations. Container operations (such as listing a
container) operate in the container threads, and a similar pattern
applies to object and segment threads.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Object threads are separated into two separate thread pools:
<code class="docutils literal notranslate"><span class="pre">uu</span></code> and <code class="docutils literal notranslate"><span class="pre">dd</span></code>. This stands for “upload/update” and “download/delete”,
and the corresponding actions will be run on separate threads pools.</p>
</div>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">segment_size</span></code>: <code class="docutils literal notranslate"><span class="pre">None</span></code></dt><dd><p>If specified, this option enables uploading of large objects. Should the
object being uploaded be larger than 5G in size, this option is
mandatory otherwise the upload will fail. This option should be
specified as a size in bytes.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">use_slo</span></code>: <code class="docutils literal notranslate"><span class="pre">False</span></code></dt><dd><p>Used in combination with the above option, <code class="docutils literal notranslate"><span class="pre">use_slo</span></code> will upload large
objects as static rather than dynamic. Only static large objects provide
error checking for the downloaded object, so we recommend this option.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">segment_container</span></code>: <code class="docutils literal notranslate"><span class="pre">None</span></code></dt><dd><p>Allows the user to select the container into which large object segments
will be uploaded. We do not recommend changing this value as it could make
locating orphaned segments more difficult in the case of errors.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">leave_segments</span></code>: <code class="docutils literal notranslate"><span class="pre">False</span></code></dt><dd><p>Setting this option to true means that when deleting or overwriting a large
object, its segments will be left in the object store and must be cleaned
up manually. This option can be useful when sharing large object segments
between multiple objects in more advanced scenarios, but must be treated
with care, as it could lead to ever increasing storage usage.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">changed</span></code>: <code class="docutils literal notranslate"><span class="pre">None</span></code></dt><dd><p>This option affects uploads and simply means that those objects which
already exist in the object store will not be overwritten if the <code class="docutils literal notranslate"><span class="pre">mtime</span></code>
and size of the source is the same as the existing object.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">skip_identical</span></code>: <code class="docutils literal notranslate"><span class="pre">False</span></code></dt><dd><p>A slightly more thorough case of the above, but rather than <code class="docutils literal notranslate"><span class="pre">mtime</span></code> and size
uses an object’s <code class="docutils literal notranslate"><span class="pre">MD5</span> <span class="pre">sum</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">yes_all</span></code>: <code class="docutils literal notranslate"><span class="pre">False</span></code></dt><dd><p>This options affects only download and delete, and in each case must be
specified in order to download/delete the entire contents of an account.
This option has no effect on any other calls.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">no_download</span></code>: <code class="docutils literal notranslate"><span class="pre">False</span></code></dt><dd><p>This option only affects download and means that all operations proceed as
normal with the exception that no data is written to disk.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">header</span></code>: <code class="docutils literal notranslate"><span class="pre">[]</span></code></dt><dd><p>Used with upload and post operations to set headers on objects. Headers
are specified as colon separated strings, e.g. “content-type:text/plain”.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">meta</span></code>: <code class="docutils literal notranslate"><span class="pre">[]</span></code></dt><dd><p>Used to set metadata on an object similarly to headers.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Setting metadata is a destructive operation, so when updating one
of many metadata values all desired metadata for an object must be re-applied.</p>
</div>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">long</span></code>: <code class="docutils literal notranslate"><span class="pre">False</span></code></dt><dd><p>Affects only list operations, and results in more metrics being made
available in the results at the expense of lower performance.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">fail_fast</span></code>: <code class="docutils literal notranslate"><span class="pre">False</span></code></dt><dd><p>Applies to delete and upload operations, and attempts to abort queued
tasks in the event of errors.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">prefix</span></code>: <code class="docutils literal notranslate"><span class="pre">None</span></code></dt><dd><p>Affects list operations; only objects with the given prefix will be
returned/affected. It is not advisable to set at the service level, as
those operations that call list to discover objects on which they should
operate will also be affected.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">delimiter</span></code>: <code class="docutils literal notranslate"><span class="pre">None</span></code></dt><dd><p>Affects list operations, and means that listings only contain results up
to the first instance of the delimiter in the object name. This is useful
for working with objects containing ‘/’ in their names to simulate folder
structures.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dir_marker</span></code>: <code class="docutils literal notranslate"><span class="pre">False</span></code></dt><dd><p>Affects uploads, and allows empty ‘pseudofolder’ objects to be created
when the source of an upload is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">checksum</span></code>: <code class="docutils literal notranslate"><span class="pre">True</span></code></dt><dd><p>Affects uploads and downloads. If set check md5 sum for the transfer.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">shuffle</span></code>: <code class="docutils literal notranslate"><span class="pre">False</span></code></dt><dd><p>When downloading objects, the default behaviour of the CLI is to shuffle
lists of objects in order to spread the load on storage drives when multiple
clients are downloading the same files to multiple locations (e.g. in the
event of distributing an update). When using the <code class="docutils literal notranslate"><span class="pre">SwiftService</span></code> directly,
object downloads are scheduled in the same order as they appear in the container
listing. When combined with a single download thread this means that objects
are downloaded in lexically-sorted order. Setting this option to <code class="docutils literal notranslate"><span class="pre">True</span></code>
gives the same shuffling behaviour as the CLI.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">destination</span></code>: <code class="docutils literal notranslate"><span class="pre">None</span></code></dt><dd><p>When copying objects, this specifies the destination where the object
will be copied to.  The default of None means copy will be the same as
source.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">fresh_metadata</span></code>: <code class="docutils literal notranslate"><span class="pre">None</span></code></dt><dd><p>When copying objects, this specifies that the object metadata on the
source will <em>not</em> be applied to the destination object - the
destination object will have a new fresh set of metadata that includes
<em>only</em> the metadata specified in the meta option if any at all.</p>
</dd>
</dl>
<p>Other available options can be found in <code class="docutils literal notranslate"><span class="pre">swiftclient/service.py</span></code> in the
source code for <code class="docutils literal notranslate"><span class="pre">python-swiftclient</span></code>. Each <code class="docutils literal notranslate"><span class="pre">SwiftService</span></code> method also allows
for an optional dictionary to override those specified at init time, and the
appropriate docstrings show which options modify each method’s behaviour.</p>
</section>
</section>
<section id="available-operations">
<h2>Available Operations<a class="headerlink" href="#available-operations" title="Link to this heading">¶</a></h2>
<p>Each operation provided by the service API may raise a <code class="docutils literal notranslate"><span class="pre">SwiftError</span></code> or
<code class="docutils literal notranslate"><span class="pre">ClientException</span></code> for any call that fails completely (or a call which
performs only one operation at an account or container level). In the case of a
successful call an operation returns one of the following:</p>
<ul class="simple">
<li><p>A dictionary detailing the results of a single operation.</p></li>
<li><p>An iterator that produces result dictionaries (for calls that perform
multiple sub-operations).</p></li>
</ul>
<p>A result dictionary can indicate either the success or failure of an individual
operation (detailed in the <code class="docutils literal notranslate"><span class="pre">success</span></code> key), and will either contain the
successful result, or an <code class="docutils literal notranslate"><span class="pre">error</span></code> key detailing the error encountered
(usually an instance of Exception).</p>
<p>An example result dictionary is given below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;download_object&#39;</span><span class="p">,</span>
    <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;container&#39;</span><span class="p">:</span> <span class="n">container</span><span class="p">,</span>
    <span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="n">obj</span><span class="p">,</span>
    <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">path</span><span class="p">,</span>
    <span class="s1">&#39;start_time&#39;</span><span class="p">:</span> <span class="n">start_time</span><span class="p">,</span>
    <span class="s1">&#39;finish_time&#39;</span><span class="p">:</span> <span class="n">finish_time</span><span class="p">,</span>
    <span class="s1">&#39;headers_receipt&#39;</span><span class="p">:</span> <span class="n">headers_receipt</span><span class="p">,</span>
    <span class="s1">&#39;auth_end_time&#39;</span><span class="p">:</span> <span class="n">conn</span><span class="o">.</span><span class="n">auth_end_time</span><span class="p">,</span>
    <span class="s1">&#39;read_length&#39;</span><span class="p">:</span> <span class="n">bytes_read</span><span class="p">,</span>
    <span class="s1">&#39;attempts&#39;</span><span class="p">:</span> <span class="n">conn</span><span class="o">.</span><span class="n">attempts</span>
<span class="p">}</span>
</pre></div>
</div>
<p>All the possible <code class="docutils literal notranslate"><span class="pre">action</span></code> values are detailed below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
    <span class="s1">&#39;stat_account&#39;</span><span class="p">,</span>
    <span class="s1">&#39;stat_container&#39;</span><span class="p">,</span>
    <span class="s1">&#39;stat_object&#39;</span><span class="p">,</span>
    <span class="s1">&#39;post_account&#39;</span><span class="p">,</span>
    <span class="s1">&#39;post_container&#39;</span><span class="p">,</span>
    <span class="s1">&#39;post_object&#39;</span><span class="p">,</span>
    <span class="s1">&#39;list_part&#39;</span><span class="p">,</span>          <span class="c1"># list yields zero or more &#39;list_part&#39; results</span>
    <span class="s1">&#39;download_object&#39;</span><span class="p">,</span>
    <span class="s1">&#39;create_container&#39;</span><span class="p">,</span>   <span class="c1"># from upload</span>
    <span class="s1">&#39;create_dir_marker&#39;</span><span class="p">,</span>  <span class="c1"># from upload</span>
    <span class="s1">&#39;upload_object&#39;</span><span class="p">,</span>
    <span class="s1">&#39;upload_segment&#39;</span><span class="p">,</span>
    <span class="s1">&#39;delete_container&#39;</span><span class="p">,</span>
    <span class="s1">&#39;delete_object&#39;</span><span class="p">,</span>
    <span class="s1">&#39;delete_segment&#39;</span><span class="p">,</span>     <span class="c1"># from delete_object operations</span>
    <span class="s1">&#39;capabilities&#39;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
<section id="stat">
<h3>Stat<a class="headerlink" href="#stat" title="Link to this heading">¶</a></h3>
<p>Stat can be called against an account, a container, or a list of objects to
get account stats, container stats or information about the given objects. In
the first two cases a dictionary is returned containing the results of the
operation, and in the case of a list of object names being supplied, an
iterator over the results generated for each object is returned.</p>
<p>Information returned includes the amount of data used by the given
object/container/account and any headers or metadata set (this includes
user set data as well as content-type and modification times).</p>
<p>See <a class="reference internal" href="swiftclient.html#swiftclient.service.SwiftService.stat" title="swiftclient.service.SwiftService.stat"><code class="xref py py-mod docutils literal notranslate"><span class="pre">swiftclient.service.SwiftService.stat</span></code></a> for docs generated from the
method docstring.</p>
<p>Valid calls for this method are as follows:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">stat([options])</span></code>: Returns stats for the configured account.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stat(&lt;container&gt;,</span> <span class="pre">[options])</span></code>: Returns stats for the given container.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stat(&lt;container&gt;,</span> <span class="pre">&lt;object_list&gt;,</span> <span class="pre">[options])</span></code>: Returns stats for each
of the given objects in the given container (through the returned
iterator).</p></li>
</ul>
<p>Results from stat are dictionaries indicating the success or failure of each
operation. In the case of a successful stat against an account or container,
the method returns immediately with one of the following results:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;stat_account&#39;</span><span class="p">,</span>
    <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;items&#39;</span><span class="p">:</span> <span class="n">items</span><span class="p">,</span>
    <span class="s1">&#39;headers&#39;</span><span class="p">:</span> <span class="n">headers</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;stat_container&#39;</span><span class="p">,</span>
    <span class="s1">&#39;container&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">container</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;items&#39;</span><span class="p">:</span> <span class="n">items</span><span class="p">,</span>
    <span class="s1">&#39;headers&#39;</span><span class="p">:</span> <span class="n">headers</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the case of stat called against a list of objects, the method returns a
generator that returns the results of individual object stat operations as they
are performed on the thread pool:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;stat_object&#39;</span><span class="p">,</span>
    <span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">object_name</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;container&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">container</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;items&#39;</span><span class="p">:</span> <span class="n">items</span><span class="p">,</span>
    <span class="s1">&#39;headers&#39;</span><span class="p">:</span> <span class="n">headers</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the case of a failure the dictionary returned will indicate that the
operation was not successful, and will include the keys below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="s1">&#39;stat_object&#39;</span><span class="o">|</span><span class="s1">&#39;stat_container&#39;</span><span class="o">|</span><span class="s1">&#39;stat_account&#39;</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="s1">&#39;object_name&#39;</span><span class="o">&gt;</span><span class="p">,</span>      <span class="c1"># Only for stat with objects list</span>
    <span class="s1">&#39;container&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">container</span><span class="o">&gt;</span><span class="p">,</span>       <span class="c1"># Only for stat with objects list or container</span>
    <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">error</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;traceback&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">trace</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;error_timestamp&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">timestamp</span><span class="o">&gt;</span>
<span class="p">}</span>
</pre></div>
</div>
<aside class="topic">
<p class="topic-title">Example</p>
<p>The code below demonstrates the use of <code class="docutils literal notranslate"><span class="pre">stat</span></code> to retrieve the headers for
a given list of objects in a container using 20 threads. The code creates a
mapping from object name to headers which is then pretty printed to the log.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pprint</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">swiftclient.service</span><span class="w"> </span><span class="kn">import</span> <span class="n">SwiftService</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sys</span><span class="w"> </span><span class="kn">import</span> <span class="n">argv</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;requests&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;swiftclient&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">)</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">_opts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;object_dd_threads&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">}</span>
<span class="k">with</span> <span class="n">SwiftService</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="n">_opts</span><span class="p">)</span> <span class="k">as</span> <span class="n">swift</span><span class="p">:</span>
    <span class="n">container</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
    <span class="n">header_data</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">stats_it</span> <span class="o">=</span> <span class="n">swift</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">container</span><span class="o">=</span><span class="n">container</span><span class="p">,</span> <span class="n">objects</span><span class="o">=</span><span class="n">objects</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">stat_res</span> <span class="ow">in</span> <span class="n">stats_it</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">stat_res</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]:</span>
            <span class="n">header_data</span><span class="p">[</span><span class="n">stat_res</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">stat_res</span><span class="p">[</span><span class="s1">&#39;headers&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="s1">&#39;Failed to retrieve stats for </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">stat_res</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">]</span>
            <span class="p">)</span>
    <span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">header_data</span><span class="p">)</span>
</pre></div>
</div>
</aside>
</section>
<section id="list">
<h3>List<a class="headerlink" href="#list" title="Link to this heading">¶</a></h3>
<p>List can be called against an account or a container to retrieve the containers
or objects contained within them. Each call returns an iterator that returns
pages of results (by default, up to 10000 results in each page).</p>
<p>See <a class="reference internal" href="swiftclient.html#swiftclient.service.SwiftService.list" title="swiftclient.service.SwiftService.list"><code class="xref py py-mod docutils literal notranslate"><span class="pre">swiftclient.service.SwiftService.list</span></code></a> for docs generated from the
method docstring.</p>
<p>If the given container or account does not exist, the list method will raise
a <code class="docutils literal notranslate"><span class="pre">SwiftError</span></code>, but for all other success/failures a dictionary is returned.
Each successfully listed page returns a dictionary as described below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="s1">&#39;list_account_part&#39;</span><span class="o">|</span><span class="s1">&#39;list_container_part&#39;</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;container&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">container</span><span class="o">&gt;</span><span class="p">,</span>      <span class="c1"># Only for listing a container</span>
    <span class="s1">&#39;prefix&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">prefix</span><span class="o">&gt;</span><span class="p">,</span>            <span class="c1"># The prefix of returned objects/containers</span>
    <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;listing&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">Item</span><span class="p">],</span>             <span class="c1"># A list of results</span>
                                   <span class="c1"># (only in the event of success)</span>
    <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">marker</span><span class="o">&gt;</span>             <span class="c1"># The last item name in the list</span>
                                   <span class="c1"># (only in the event of success)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Where an item contains the following keys:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;bytes&#39;</span><span class="p">:</span> <span class="mi">10485760</span><span class="p">,</span>
    <span class="s1">&#39;last_modified&#39;</span><span class="p">:</span> <span class="s1">&#39;2014-12-11T12:02:38.774540&#39;</span><span class="p">,</span>
    <span class="s1">&#39;hash&#39;</span><span class="p">:</span> <span class="s1">&#39;fb938269cbeabe4c234e1127bbd3b74a&#39;</span><span class="p">,</span>
    <span class="s1">&#39;content_type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/octet-stream&#39;</span><span class="p">,</span>
    <span class="s1">&#39;meta&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">metadata</span><span class="o">&gt;</span>    <span class="c1"># Full metadata listing from stat&#39;ing each object</span>
                          <span class="c1"># this key only exists if &#39;long&#39; is specified in options</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Any failure listing an account or container that exists will return a failure
dictionary as described below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="s1">&#39;list_account_part&#39;</span><span class="o">|</span><span class="s1">&#39;list_container_part&#39;</span><span class="o">&gt;</span><span class="p">,,</span>
    <span class="s1">&#39;container&#39;</span><span class="p">:</span> <span class="n">container</span><span class="p">,</span>         <span class="c1"># Only for listing a container</span>
    <span class="s1">&#39;prefix&#39;</span><span class="p">:</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;prefix&#39;</span><span class="p">],</span>
    <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="n">success</span><span class="p">,</span>
    <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="n">marker</span><span class="p">,</span>
    <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="n">error</span><span class="p">,</span>
    <span class="s1">&#39;traceback&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">trace</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;error_timestamp&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">timestamp</span><span class="o">&gt;</span>
<span class="p">}</span>
</pre></div>
</div>
<aside class="topic">
<p class="topic-title">Example</p>
<p>The code below demonstrates the use of <code class="docutils literal notranslate"><span class="pre">list</span></code> to list all items in a
container that are over 10MiB in size:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">swiftclient.service</span><span class="w"> </span><span class="kn">import</span> <span class="n">SwiftService</span><span class="p">,</span> <span class="n">SwiftError</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sys</span><span class="w"> </span><span class="kn">import</span> <span class="n">argv</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;requests&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;swiftclient&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">)</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">container</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">minimum_size</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="mi">1024</span><span class="o">**</span><span class="mi">2</span>
<span class="k">with</span> <span class="n">SwiftService</span><span class="p">()</span> <span class="k">as</span> <span class="n">swift</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">list_parts_gen</span> <span class="o">=</span> <span class="n">swift</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">container</span><span class="o">=</span><span class="n">container</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">list_parts_gen</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">page</span><span class="p">[</span><span class="s2">&quot;success&quot;</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">page</span><span class="p">[</span><span class="s2">&quot;listing&quot;</span><span class="p">]:</span>

                    <span class="n">i_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;bytes&quot;</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">i_size</span> <span class="o">&gt;</span> <span class="n">minimum_size</span><span class="p">:</span>
                        <span class="n">i_name</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
                        <span class="n">i_etag</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;hash&quot;</span><span class="p">]</span>
                        <span class="nb">print</span><span class="p">(</span>
                            <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> [size: </span><span class="si">%s</span><span class="s2">] [etag: </span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span>
                            <span class="p">(</span><span class="n">i_name</span><span class="p">,</span> <span class="n">i_size</span><span class="p">,</span> <span class="n">i_etag</span><span class="p">)</span>
                        <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">page</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span>

    <span class="k">except</span> <span class="n">SwiftError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</aside>
</section>
<section id="post">
<h3>Post<a class="headerlink" href="#post" title="Link to this heading">¶</a></h3>
<p>Post can be called against an account, container or list of objects in order to
update the metadata attached to the given items. In the first two cases a single
dictionary is returned containing the results of the operation, and in the case
of a list of objects being supplied, an iterator over the results generated for
each object post is returned.</p>
<p>Each element of the object list may be a plain string of the object name, or a
<code class="docutils literal notranslate"><span class="pre">SwiftPostObject</span></code> that allows finer control over the options and metadata
applied to each of the individual post operations. When a string is given for
the object name, the options and metadata applied are a combination of those
supplied to the call to <code class="docutils literal notranslate"><span class="pre">post()</span></code> and the defaults of the <code class="docutils literal notranslate"><span class="pre">SwiftService</span></code>
object.</p>
<p>If the given container or account does not exist, the <code class="docutils literal notranslate"><span class="pre">post</span></code> method will
raise a <code class="docutils literal notranslate"><span class="pre">SwiftError</span></code>. Successful metadata update results are dictionaries as
described below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="s1">&#39;post_account&#39;</span><span class="o">|</span><span class="s1">&#39;post_container&#39;</span><span class="o">|</span><span class="s1">&#39;post_object&#39;</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;container&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">container</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="nb">object</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;headers&#39;</span><span class="p">:</span> <span class="p">{},</span>
    <span class="s1">&#39;response_dict&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">HTTP</span> <span class="n">response</span> <span class="n">details</span><span class="o">&gt;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Updating user metadata keys will not only add any specified keys, but
will also remove user metadata that has previously been set. This means
that each time user metadata is updated, the complete set of desired
key-value pairs must be specified.</p>
</div>
<aside class="topic">
<p class="topic-title">Example</p>
<p>The code below demonstrates the use of <code class="docutils literal notranslate"><span class="pre">post</span></code> to set an archive folder in
a given container to expire after a 24 hour delay:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">swiftclient.service</span><span class="w"> </span><span class="kn">import</span> <span class="n">SwiftService</span><span class="p">,</span> <span class="n">SwiftError</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sys</span><span class="w"> </span><span class="kn">import</span> <span class="n">argv</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;requests&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;swiftclient&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">)</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">container</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="k">with</span> <span class="n">SwiftService</span><span class="p">()</span> <span class="k">as</span> <span class="n">swift</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">list_options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;archive_2016-01-01/&quot;</span><span class="p">}</span>
        <span class="n">list_parts_gen</span> <span class="o">=</span> <span class="n">swift</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">container</span><span class="o">=</span><span class="n">container</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">list_parts_gen</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">page</span><span class="p">[</span><span class="s2">&quot;success&quot;</span><span class="p">]:</span>
                <span class="n">objects</span> <span class="o">=</span> <span class="p">[</span><span class="n">obj</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">page</span><span class="p">[</span><span class="s2">&quot;listing&quot;</span><span class="p">]]</span>
                <span class="n">post_options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="s2">&quot;X-Delete-After:86400&quot;</span><span class="p">}</span>
                <span class="k">for</span> <span class="n">post_res</span> <span class="ow">in</span> <span class="n">swift</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
                        <span class="n">container</span><span class="o">=</span><span class="n">container</span><span class="p">,</span>
                        <span class="n">objects</span><span class="o">=</span><span class="n">objects</span><span class="p">,</span>
                        <span class="n">options</span><span class="o">=</span><span class="n">post_options</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">post_res</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Object &#39;</span><span class="si">%s</span><span class="s2">&#39; POST success&quot;</span> <span class="o">%</span> <span class="n">post_res</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Object &#39;</span><span class="si">%s</span><span class="s2">&#39; POST failed&quot;</span> <span class="o">%</span> <span class="n">post_res</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">page</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span>
    <span class="k">except</span> <span class="n">SwiftError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</aside>
</section>
<section id="download">
<h3>Download<a class="headerlink" href="#download" title="Link to this heading">¶</a></h3>
<p>Download can be called against an entire account, a single container, or a list
of objects in a given container. Each element of the object list is a string
detailing the full name of an object to download.</p>
<p>In order to download the full contents of an entire account, you must set the
value of <code class="docutils literal notranslate"><span class="pre">yes_all</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code> in the <code class="docutils literal notranslate"><span class="pre">options</span></code> dictionary supplied to
either the <code class="docutils literal notranslate"><span class="pre">SwiftService</span></code> instance or the call to <code class="docutils literal notranslate"><span class="pre">download</span></code>.</p>
<p>If the given container or account does not exist, the <code class="docutils literal notranslate"><span class="pre">download</span></code> method will
raise a <code class="docutils literal notranslate"><span class="pre">SwiftError</span></code>, otherwise an iterator over the results generated for
each object download is returned.</p>
<p>See <a class="reference internal" href="swiftclient.html#swiftclient.service.SwiftService.download" title="swiftclient.service.SwiftService.download"><code class="xref py py-mod docutils literal notranslate"><span class="pre">swiftclient.service.SwiftService.download</span></code></a> for docs generated from the
method docstring.</p>
<p>For each successfully downloaded object, the results returned by the iterator
will be a dictionary as described below (results are not returned for completed
container or object segment downloads):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;download_object&#39;</span><span class="p">,</span>
    <span class="s1">&#39;container&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">container</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="nb">object</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">local</span> <span class="n">path</span> <span class="n">to</span> <span class="n">downloaded</span> <span class="nb">object</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;pseudodir&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="k">if</span> <span class="n">true</span><span class="p">,</span> <span class="n">the</span> <span class="n">download</span> <span class="n">created</span> <span class="n">an</span> <span class="n">empty</span> <span class="n">directory</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;start_time&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">time</span> <span class="n">download</span> <span class="n">started</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;end_time&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">time</span> <span class="n">download</span> <span class="n">completed</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;headers_receipt&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">time</span> <span class="n">the</span> <span class="n">headers</span> <span class="kn">from</span><span class="w"> </span><span class="nn">the</span> <span class="nb">object</span> <span class="n">were</span> <span class="n">retrieved</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;auth_end_time&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">time</span> <span class="n">authentication</span> <span class="n">completed</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;read_length&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">bytes_read</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;attempts&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">attempt</span> <span class="n">count</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;response_dict&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">HTTP</span> <span class="n">response</span> <span class="n">details</span><span class="o">&gt;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Any failure uploading an object will return a failure dictionary as described
below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;download_object&#39;</span><span class="p">,</span>
    <span class="s1">&#39;container&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">container</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="nb">object</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">local</span> <span class="n">path</span> <span class="n">of</span> <span class="n">the</span> <span class="n">failed</span> <span class="n">download</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;pseudodir&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="k">if</span> <span class="n">true</span><span class="p">,</span> <span class="n">the</span> <span class="n">failed</span> <span class="n">download</span> <span class="n">was</span> <span class="n">an</span> <span class="n">empty</span> <span class="n">directory</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;attempts&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">attempt</span> <span class="n">count</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">error</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;traceback&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">trace</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;error_timestamp&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">timestamp</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;response_dict&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">HTTP</span> <span class="n">response</span> <span class="n">details</span><span class="o">&gt;</span>
<span class="p">}</span>
</pre></div>
</div>
<aside class="topic">
<p class="topic-title">Example</p>
<p>The code below demonstrates the use of <code class="docutils literal notranslate"><span class="pre">download</span></code> to download all PNG
images from a dated archive folder in a given container:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">swiftclient.service</span><span class="w"> </span><span class="kn">import</span> <span class="n">SwiftService</span><span class="p">,</span> <span class="n">SwiftError</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sys</span><span class="w"> </span><span class="kn">import</span> <span class="n">argv</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;requests&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;swiftclient&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">)</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">is_png</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span> <span class="ow">or</span>
        <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;content_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;image/png&#39;</span>
    <span class="p">)</span>

<span class="n">container</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="k">with</span> <span class="n">SwiftService</span><span class="p">()</span> <span class="k">as</span> <span class="n">swift</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">list_options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;archive_2016-01-01/&quot;</span><span class="p">}</span>
        <span class="n">list_parts_gen</span> <span class="o">=</span> <span class="n">swift</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">container</span><span class="o">=</span><span class="n">container</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">list_parts_gen</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">page</span><span class="p">[</span><span class="s2">&quot;success&quot;</span><span class="p">]:</span>
                <span class="n">objects</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">page</span><span class="p">[</span><span class="s2">&quot;listing&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">is_png</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
                <span class="p">]</span>
                <span class="k">for</span> <span class="n">down_res</span> <span class="ow">in</span> <span class="n">swift</span><span class="o">.</span><span class="n">download</span><span class="p">(</span>
                        <span class="n">container</span><span class="o">=</span><span class="n">container</span><span class="p">,</span>
                        <span class="n">objects</span><span class="o">=</span><span class="n">objects</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">down_res</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39; downloaded&quot;</span> <span class="o">%</span> <span class="n">down_res</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39; download failed&quot;</span> <span class="o">%</span> <span class="n">down_res</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">page</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span>
    <span class="k">except</span> <span class="n">SwiftError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</aside>
</section>
<section id="upload">
<h3>Upload<a class="headerlink" href="#upload" title="Link to this heading">¶</a></h3>
<p>Upload is always called against an account and container and with a list of
objects to upload. Each element of the object list may be a plain string
detailing the path of the object to upload, or a <code class="docutils literal notranslate"><span class="pre">SwiftUploadObject</span></code> that
allows finer control over some aspects of the individual operations.</p>
<p>When a simple string is supplied to specify a file to upload, the name of the
object uploaded is the full path of the specified file and the options used for
the upload are those supplied to the call to <code class="docutils literal notranslate"><span class="pre">upload</span></code>.</p>
<p>Constructing a <code class="docutils literal notranslate"><span class="pre">SwiftUploadObject</span></code> allows the user to supply an object name
for the uploaded file, and modify the options used by <code class="docutils literal notranslate"><span class="pre">upload</span></code> at the
granularity of individual files.</p>
<p>If the given container or account does not exist, the <code class="docutils literal notranslate"><span class="pre">upload</span></code> method will
raise a <code class="docutils literal notranslate"><span class="pre">SwiftError</span></code>, otherwise an iterator over the results generated for
each object upload is returned.</p>
<p>See <a class="reference internal" href="swiftclient.html#swiftclient.service.SwiftService.upload" title="swiftclient.service.SwiftService.upload"><code class="xref py py-mod docutils literal notranslate"><span class="pre">swiftclient.service.SwiftService.upload</span></code></a> for docs generated from the
method docstring.</p>
<p>For each successfully uploaded object (or object segment), the results returned
by the iterator will be a dictionary as described below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;upload_object&#39;</span><span class="p">,</span>
    <span class="s1">&#39;container&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">container</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="nb">object</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="s1">&#39;uploaded&#39;</span><span class="o">|</span><span class="s1">&#39;skipped-identical&#39;</span><span class="o">|</span><span class="s1">&#39;skipped-changed&#39;</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;attempts&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">attempt</span> <span class="n">count</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;response_dict&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">HTTP</span> <span class="n">response</span> <span class="n">details</span><span class="o">&gt;</span>
<span class="p">}</span>

<span class="p">{</span>
    <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;upload_segment&#39;</span><span class="p">,</span>
    <span class="s1">&#39;for_container&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">container</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;for_object&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="nb">object</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;segment_index&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">segment_index</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;segment_size&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">segment_size</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;segment_location&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">segment_path</span><span class="o">&gt;</span>
    <span class="s1">&#39;segment_etag&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">etag</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;log_line&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="nb">object</span> <span class="n">segment</span> <span class="n">n</span><span class="o">&gt;</span>
    <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;response_dict&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">HTTP</span> <span class="n">response</span> <span class="n">details</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;attempts&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">attempt</span> <span class="n">count</span><span class="o">&gt;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Any failure uploading an object will return a failure dictionary as described
below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;upload_object&#39;</span><span class="p">,</span>
    <span class="s1">&#39;container&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">container</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="nb">object</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;attempts&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">attempt</span> <span class="n">count</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">error</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;traceback&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">trace</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;error_timestamp&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">timestamp</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;response_dict&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">HTTP</span> <span class="n">response</span> <span class="n">details</span><span class="o">&gt;</span>
<span class="p">}</span>

<span class="p">{</span>
    <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;upload_segment&#39;</span><span class="p">,</span>
    <span class="s1">&#39;for_container&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">container</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;for_object&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="nb">object</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;segment_index&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">segment_index</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;segment_size&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">segment_size</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;segment_location&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">segment_path</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;log_line&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="nb">object</span> <span class="n">segment</span> <span class="n">n</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">error</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;traceback&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">trace</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;error_timestamp&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">timestamp</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;response_dict&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">HTTP</span> <span class="n">response</span> <span class="n">details</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;attempts&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">attempt</span> <span class="n">count</span><span class="o">&gt;</span>
<span class="p">}</span>
</pre></div>
</div>
<aside class="topic">
<p class="topic-title">Example</p>
<p>The code below demonstrates the use of <code class="docutils literal notranslate"><span class="pre">upload</span></code> to upload all files and
folders in a given directory, and rename each object by replacing the root
directory name with ‘my-&lt;d&gt;-objects’, where &lt;d&gt; is the name of the uploaded
directory:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">os</span><span class="w"> </span><span class="kn">import</span> <span class="n">walk</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">os.path</span><span class="w"> </span><span class="kn">import</span> <span class="n">join</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">swiftclient.multithreading</span><span class="w"> </span><span class="kn">import</span> <span class="n">OutputManager</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">swiftclient.service</span><span class="w"> </span><span class="kn">import</span> <span class="n">SwiftError</span><span class="p">,</span> <span class="n">SwiftService</span><span class="p">,</span> <span class="n">SwiftUploadObject</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sys</span><span class="w"> </span><span class="kn">import</span> <span class="n">argv</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;requests&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;swiftclient&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">)</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">_opts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;object_uu_threads&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">}</span>
<span class="nb">dir</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">container</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="k">with</span> <span class="n">SwiftService</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="n">_opts</span><span class="p">)</span> <span class="k">as</span> <span class="n">swift</span><span class="p">,</span> <span class="n">OutputManager</span><span class="p">()</span> <span class="k">as</span> <span class="n">out_manager</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Collect all the files and folders in the given directory</span>
        <span class="n">objs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">dir_markers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">_dir</span><span class="p">,</span> <span class="n">_ds</span><span class="p">,</span> <span class="n">_fs</span><span class="p">)</span> <span class="ow">in</span> <span class="n">walk</span><span class="p">(</span><span class="nb">dir</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">_ds</span> <span class="o">+</span> <span class="n">_fs</span><span class="p">):</span>
                <span class="n">dir_markers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_dir</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">objs</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">join</span><span class="p">(</span><span class="n">_dir</span><span class="p">,</span> <span class="n">_f</span><span class="p">)</span> <span class="k">for</span> <span class="n">_f</span> <span class="ow">in</span> <span class="n">_fs</span><span class="p">])</span>

        <span class="c1"># Now that we&#39;ve collected all the required files and dir markers</span>
        <span class="c1"># build the ``SwiftUploadObject``s for the call to upload</span>
        <span class="n">objs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">SwiftUploadObject</span><span class="p">(</span>
                <span class="n">o</span><span class="p">,</span> <span class="n">object_name</span><span class="o">=</span><span class="n">o</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                    <span class="nb">dir</span><span class="p">,</span> <span class="s1">&#39;my-</span><span class="si">%s</span><span class="s1">-objects&#39;</span> <span class="o">%</span> <span class="nb">dir</span><span class="p">,</span> <span class="mi">1</span>
                <span class="p">)</span>
            <span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">objs</span>
        <span class="p">]</span>
        <span class="n">dir_markers</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">SwiftUploadObject</span><span class="p">(</span>
                <span class="kc">None</span><span class="p">,</span> <span class="n">object_name</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                    <span class="nb">dir</span><span class="p">,</span> <span class="s1">&#39;my-</span><span class="si">%s</span><span class="s1">-objects&#39;</span> <span class="o">%</span> <span class="nb">dir</span><span class="p">,</span> <span class="mi">1</span>
                <span class="p">),</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dir_marker&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
            <span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dir_markers</span>
        <span class="p">]</span>

        <span class="c1"># Schedule uploads on the SwiftService thread pool and iterate</span>
        <span class="c1"># over the results</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">swift</span><span class="o">.</span><span class="n">upload</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">objs</span> <span class="o">+</span> <span class="n">dir_markers</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="s1">&#39;object&#39;</span> <span class="ow">in</span> <span class="n">r</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">])</span>
                <span class="k">elif</span> <span class="s1">&#39;for_object&#39;</span> <span class="ow">in</span> <span class="n">r</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span>
                        <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> segment </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;for_object&#39;</span><span class="p">],</span>
                                           <span class="n">r</span><span class="p">[</span><span class="s1">&#39;segment_index&#39;</span><span class="p">])</span>
                        <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">error</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;create_container&quot;</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                        <span class="s1">&#39;Warning: failed to create container &#39;</span>
                        <span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39;</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">container</span><span class="p">,</span> <span class="n">error</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;upload_object&quot;</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                        <span class="s2">&quot;Failed to upload object </span><span class="si">%s</span><span class="s2"> to container </span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span>
                        <span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">],</span> <span class="n">error</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">error</span><span class="p">)</span>

    <span class="k">except</span> <span class="n">SwiftError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</aside>
</section>
<section id="delete">
<h3>Delete<a class="headerlink" href="#delete" title="Link to this heading">¶</a></h3>
<p>Delete can be called against an account or a container to remove the containers
or objects contained within them. Each call to <code class="docutils literal notranslate"><span class="pre">delete</span></code> returns an iterator
over results of each resulting sub-request.</p>
<p>If the number of requested delete operations is large and the target swift
cluster is running the bulk middleware, the call to <code class="docutils literal notranslate"><span class="pre">SwiftService.delete</span></code> will
make use of bulk operations and the returned result iterator will return
<code class="docutils literal notranslate"><span class="pre">bulk_delete</span></code> results rather than individual <code class="docutils literal notranslate"><span class="pre">delete_object</span></code>,
<code class="docutils literal notranslate"><span class="pre">delete_container</span></code> or <code class="docutils literal notranslate"><span class="pre">delete_segment</span></code> results.</p>
<p>See <a class="reference internal" href="swiftclient.html#swiftclient.service.SwiftService.delete" title="swiftclient.service.SwiftService.delete"><code class="xref py py-mod docutils literal notranslate"><span class="pre">swiftclient.service.SwiftService.delete</span></code></a> for docs generated from the
method docstring.</p>
<p>For each successfully deleted container, object or segment, the results returned
by the iterator will be a dictionary as described below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="s1">&#39;delete_object&#39;</span><span class="o">|</span><span class="s1">&#39;delete_segment&#39;</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;container&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">container</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="nb">object</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;attempts&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">attempt</span> <span class="n">count</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;response_dict&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">HTTP</span> <span class="n">response</span> <span class="n">details</span><span class="o">&gt;</span>
<span class="p">}</span>

<span class="p">{</span>
    <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;delete_container&#39;</span><span class="p">,</span>
    <span class="s1">&#39;container&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">container</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;response_dict&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">HTTP</span> <span class="n">response</span> <span class="n">details</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;attempts&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">attempt</span> <span class="n">count</span><span class="o">&gt;</span>
<span class="p">}</span>

<span class="p">{</span>
    <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;bulk_delete&#39;</span><span class="p">,</span>
    <span class="s1">&#39;container&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">container</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;objects&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="p">[</span><span class="n">objects</span><span class="p">]</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;attempts&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">attempt</span> <span class="n">count</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;response_dict&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">HTTP</span> <span class="n">response</span> <span class="n">details</span><span class="o">&gt;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Any failure in a delete operation will return a failure dictionary as described
below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;delete_object&#39;</span><span class="o">|</span><span class="s1">&#39;delete_segment&#39;</span><span class="p">),</span>
    <span class="s1">&#39;container&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">container</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="nb">object</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;attempts&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">attempt</span> <span class="n">count</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">error</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;traceback&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">trace</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;error_timestamp&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">timestamp</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;response_dict&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">HTTP</span> <span class="n">response</span> <span class="n">details</span><span class="o">&gt;</span>
<span class="p">}</span>

<span class="p">{</span>
    <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;delete_container&#39;</span><span class="p">,</span>
    <span class="s1">&#39;container&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">container</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">error</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;traceback&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">trace</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;error_timestamp&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">timestamp</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;response_dict&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">HTTP</span> <span class="n">response</span> <span class="n">details</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;attempts&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">attempt</span> <span class="n">count</span><span class="o">&gt;</span>
<span class="p">}</span>

<span class="p">{</span>
    <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;bulk_delete&#39;</span><span class="p">,</span>
    <span class="s1">&#39;container&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">container</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;objects&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="p">[</span><span class="n">objects</span><span class="p">]</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;attempts&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">attempt</span> <span class="n">count</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">error</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;traceback&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">trace</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;error_timestamp&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">timestamp</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;response_dict&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">HTTP</span> <span class="n">response</span> <span class="n">details</span><span class="o">&gt;</span>
<span class="p">}</span>
</pre></div>
</div>
<aside class="topic">
<p class="topic-title">Example</p>
<p>The code below demonstrates the use of <code class="docutils literal notranslate"><span class="pre">delete</span></code> to remove a given list of
objects from a specified container. As the objects are deleted the
transaction ID of the relevant request is printed along with the object name
and number of attempts required. By printing the transaction ID, the printed
operations can be easily linked to events in the swift server logs:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">swiftclient.service</span><span class="w"> </span><span class="kn">import</span> <span class="n">SwiftService</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sys</span><span class="w"> </span><span class="kn">import</span> <span class="n">argv</span>


<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;requests&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;swiftclient&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">)</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">_opts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;object_dd_threads&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">}</span>
<span class="n">container</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">objects</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
<span class="k">with</span> <span class="n">SwiftService</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="n">_opts</span><span class="p">)</span> <span class="k">as</span> <span class="n">swift</span><span class="p">:</span>
    <span class="n">del_iter</span> <span class="o">=</span> <span class="n">swift</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">container</span><span class="o">=</span><span class="n">container</span><span class="p">,</span> <span class="n">objects</span><span class="o">=</span><span class="n">objects</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">del_res</span> <span class="ow">in</span> <span class="n">del_iter</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">del_res</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;container&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">o</span> <span class="o">=</span> <span class="n">del_res</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">del_res</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;attempts&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">del_res</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">del_res</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bulk_delete&#39;</span><span class="p">:</span>
            <span class="n">rd</span> <span class="o">=</span> <span class="n">del_res</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;response_dict&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">rd</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">t</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">rd</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;headers&#39;</span><span class="p">,</span> <span class="p">{}))</span>
                <span class="k">if</span> <span class="n">t</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span>
                        <span class="s1">&#39;Successfully deleted </span><span class="si">{0}</span><span class="s1">/</span><span class="si">{1}</span><span class="s1"> in </span><span class="si">{2}</span><span class="s1"> attempts &#39;</span>
                        <span class="s1">&#39;(transaction id: </span><span class="si">{3}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">o</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span>
                        <span class="s1">&#39;Successfully deleted </span><span class="si">{0}</span><span class="s1">/</span><span class="si">{1}</span><span class="s1"> in </span><span class="si">{2}</span><span class="s1"> &#39;</span>
                        <span class="s1">&#39;attempts&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">o</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
                    <span class="p">)</span>
</pre></div>
</div>
</aside>
</section>
<section id="copy">
<h3>Copy<a class="headerlink" href="#copy" title="Link to this heading">¶</a></h3>
<p>Copy can be called to copy an object or update the metadata on the given items.</p>
<p>Each element of the object list may be a plain string of the object name, or a
<code class="docutils literal notranslate"><span class="pre">SwiftCopyObject</span></code> that allows finer control over the options applied to each
of the individual copy operations (destination, fresh_metadata, options).</p>
<p>Destination should be in format /container/object; if not set, the object will be
copied onto itself. Fresh_metadata sets mode of operation on metadata. If not set,
current object user metadata will be copied/preserved; if set, all current user
metadata will be removed.</p>
<p>Returns an iterator over the results generated for each object copy (and may
also include the results of creating destination containers).</p>
<p>When a string is given for the object name, destination and fresh metadata will
default to None and None, which result in adding metadata to existing objects.</p>
<p>Successful copy results are dictionaries as described below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;copy_object&#39;</span><span class="p">,</span>
    <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;container&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">container</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="nb">object</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;destination&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">destination</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;headers&#39;</span><span class="p">:</span> <span class="p">{},</span>
    <span class="s1">&#39;fresh_metadata&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">boolean</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;response_dict&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">HTTP</span> <span class="n">response</span> <span class="n">details</span><span class="o">&gt;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Any failure in a copy operation will return a failure dictionary as described
below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;copy_object&#39;</span><span class="p">,</span>
    <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;container&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">container</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="nb">object</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;destination&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">destination</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;headers&#39;</span><span class="p">:</span> <span class="p">{},</span>
    <span class="s1">&#39;fresh_metadata&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">boolean</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;response_dict&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">HTTP</span> <span class="n">response</span> <span class="n">details</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">error</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;traceback&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">traceback</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;error_timestamp&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">timestamp</span><span class="o">&gt;</span>
<span class="p">}</span>
</pre></div>
</div>
<aside class="topic">
<p class="topic-title">Example</p>
<p>The code below demonstrates the use of <code class="docutils literal notranslate"><span class="pre">copy</span></code> to add new user metadata for
objects a and b, and to copy object c to d (with added metadata).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">swiftclient.service</span><span class="w"> </span><span class="kn">import</span> <span class="n">SwiftService</span><span class="p">,</span> <span class="n">SwiftCopyObject</span><span class="p">,</span> <span class="n">SwiftError</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;requests&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;swiftclient&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">)</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="k">with</span> <span class="n">SwiftService</span><span class="p">()</span> <span class="k">as</span> <span class="n">swift</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">SwiftCopyObject</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;destination&quot;</span><span class="p">:</span> <span class="s2">&quot;/cont/d&quot;</span><span class="p">})</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">swift</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span>
                <span class="s2">&quot;cont&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">obj</span><span class="p">],</span>
                <span class="p">{</span><span class="s2">&quot;meta&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;foo:bar&quot;</span><span class="p">],</span> <span class="s2">&quot;destination&quot;</span><span class="p">:</span> <span class="s2">&quot;/cc&quot;</span><span class="p">}):</span>
            <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="s2">&quot;success&quot;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="s2">&quot;action&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;copy_object&quot;</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span>
                        <span class="s2">&quot;object </span><span class="si">%s</span><span class="s2"> copied from /</span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span>
                        <span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="s2">&quot;destination&quot;</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="s2">&quot;container&quot;</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">])</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">i</span><span class="p">[</span><span class="s2">&quot;action&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;create_container&quot;</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span>
                        <span class="s2">&quot;container </span><span class="si">%s</span><span class="s2"> created&quot;</span> <span class="o">%</span> <span class="n">i</span><span class="p">[</span><span class="s2">&quot;container&quot;</span><span class="p">]</span>
                    <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;error&quot;</span> <span class="ow">in</span> <span class="n">i</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">],</span> <span class="ne">Exception</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">i</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span>
    <span class="k">except</span> <span class="n">SwiftError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</aside>
</section>
<section id="capabilities">
<h3>Capabilities<a class="headerlink" href="#capabilities" title="Link to this heading">¶</a></h3>
<p>Capabilities can be called against an account or a particular proxy URL in
order to determine the capabilities of the swift cluster. These capabilities
include details about configuration options and the middlewares that are
installed in the proxy pipeline.</p>
<p>See <a class="reference internal" href="swiftclient.html#swiftclient.service.SwiftService.capabilities" title="swiftclient.service.SwiftService.capabilities"><code class="xref py py-mod docutils literal notranslate"><span class="pre">swiftclient.service.SwiftService.capabilities</span></code></a> for docs generated from
the method docstring.</p>
<p>For each successful call to list capabilities, a result dictionary will be
returned with the contents described below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;capabilities&#39;</span><span class="p">,</span>
    <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">time</span> <span class="n">of</span> <span class="n">the</span> <span class="n">call</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;capabilities&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">dictionary</span> <span class="n">containing</span> <span class="n">capability</span> <span class="n">details</span><span class="o">&gt;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The contents of the capabilities dictionary contain the core swift capabilities
under the key <code class="docutils literal notranslate"><span class="pre">swift</span></code>; all other keys show the configuration options for
additional middlewares deployed in the proxy pipeline. An example capabilities
dictionary is given below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;account_quotas&#39;</span><span class="p">:</span> <span class="p">{},</span>
    <span class="s1">&#39;bulk_delete&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;max_deletes_per_request&#39;</span><span class="p">:</span> <span class="mi">10000</span><span class="p">,</span>
        <span class="s1">&#39;max_failed_deletes&#39;</span><span class="p">:</span> <span class="mi">1000</span>
    <span class="p">},</span>
    <span class="s1">&#39;bulk_upload&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;max_containers_per_extraction&#39;</span><span class="p">:</span> <span class="mi">10000</span><span class="p">,</span>
        <span class="s1">&#39;max_failed_extractions&#39;</span><span class="p">:</span> <span class="mi">1000</span>
    <span class="p">},</span>
    <span class="s1">&#39;container_quotas&#39;</span><span class="p">:</span> <span class="p">{},</span>
    <span class="s1">&#39;container_sync&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;realms&#39;</span><span class="p">:</span> <span class="p">{}},</span>
    <span class="s1">&#39;formpost&#39;</span><span class="p">:</span> <span class="p">{},</span>
    <span class="s1">&#39;keystoneauth&#39;</span><span class="p">:</span> <span class="p">{},</span>
    <span class="s1">&#39;slo&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;max_manifest_segments&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
        <span class="s1">&#39;max_manifest_size&#39;</span><span class="p">:</span> <span class="mi">2097152</span><span class="p">,</span>
        <span class="s1">&#39;min_segment_size&#39;</span><span class="p">:</span> <span class="mi">1048576</span>
    <span class="p">},</span>
    <span class="s1">&#39;swift&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;account_autocreate&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s1">&#39;account_listing_limit&#39;</span><span class="p">:</span> <span class="mi">10000</span><span class="p">,</span>
        <span class="s1">&#39;allow_account_management&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s1">&#39;container_listing_limit&#39;</span><span class="p">:</span> <span class="mi">10000</span><span class="p">,</span>
        <span class="s1">&#39;extra_header_count&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;max_account_name_length&#39;</span><span class="p">:</span> <span class="mi">256</span><span class="p">,</span>
        <span class="s1">&#39;max_container_name_length&#39;</span><span class="p">:</span> <span class="mi">256</span><span class="p">,</span>
        <span class="s1">&#39;max_file_size&#39;</span><span class="p">:</span> <span class="mi">5368709122</span><span class="p">,</span>
        <span class="s1">&#39;max_header_size&#39;</span><span class="p">:</span> <span class="mi">8192</span><span class="p">,</span>
        <span class="s1">&#39;max_meta_count&#39;</span><span class="p">:</span> <span class="mi">90</span><span class="p">,</span>
        <span class="s1">&#39;max_meta_name_length&#39;</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span>
        <span class="s1">&#39;max_meta_overall_size&#39;</span><span class="p">:</span> <span class="mi">4096</span><span class="p">,</span>
        <span class="s1">&#39;max_meta_value_length&#39;</span><span class="p">:</span> <span class="mi">256</span><span class="p">,</span>
        <span class="s1">&#39;max_object_name_length&#39;</span><span class="p">:</span> <span class="mi">1024</span><span class="p">,</span>
        <span class="s1">&#39;policies&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span><span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Policy-0&#39;</span><span class="p">}</span>
        <span class="p">],</span>
        <span class="s1">&#39;strict_cors_mode&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;2.2.2&#39;</span>
    <span class="p">},</span>
    <span class="s1">&#39;tempurl&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;methods&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;HEAD&#39;</span><span class="p">,</span> <span class="s1">&#39;PUT&#39;</span><span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<aside class="topic">
<p class="topic-title">Example</p>
<p>The code below demonstrates the use of <code class="docutils literal notranslate"><span class="pre">capabilities</span></code> to determine if the
Swift cluster supports static large objects, and if so, the maximum number
of segments that can be described in a single manifest file, along with the
size restrictions on those objects:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">swiftclient.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">ClientException</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">swiftclient.service</span><span class="w"> </span><span class="kn">import</span> <span class="n">SwiftService</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;requests&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;swiftclient&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">)</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="k">with</span> <span class="n">SwiftService</span><span class="p">()</span> <span class="k">as</span> <span class="n">swift</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">capabilities_result</span> <span class="o">=</span> <span class="n">swift</span><span class="o">.</span><span class="n">capabilities</span><span class="p">()</span>
        <span class="n">capabilities</span> <span class="o">=</span> <span class="n">capabilities_result</span><span class="p">[</span><span class="s1">&#39;capabilities&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;slo&#39;</span> <span class="ow">in</span> <span class="n">capabilities</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;SLO is supported&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;SLO is not supported&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">ClientException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</aside>
</section>
</section>
</section>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="cli/index.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: CLI"></i></a>
          
          
            <a href="client-api.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: The swiftclient.Connection API"></i></a>
          
          <a id="pdfLink2" href="" target="_blank" title="Download the manuals as PDF"><i class="fa fa-file-pdf-o" data-toggle="tooltip" data-placement="top" title="Download PDF"></i></a>
          
            <a id="logABugLink3" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">this page last updated: 2019-03-25 09:35:47</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="https://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the
                 document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 order-1 docs-sidebar">
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="OpenStack Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button type="button" data-bs-toggle="dropdown" class="btn dropdown-toggle docs-sidebar-release-select">OpenStack Documentation</button>
<ul class="dropdown-menu docs-sidebar-dropdown" role="menu">
  <li class="dropdown-header">Guides</li>
  <li><a class="dropdown-item" href="https://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
  <li><a class="dropdown-item" href="https://docs.openstack.org/index.html#user-guides">User Guides</a></li>
  <li><a class="dropdown-item" href="https://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
  <li><a class="dropdown-item" href="https://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
  <li><a class="dropdown-item" href="https://docs.openstack.org/index.html#api-guides">API Guides</a></li>
  <li><a class="dropdown-item" href="https://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
  <li class="dropdown-header">Languages</li>
  <li><a class="dropdown-item" href="https://docs.openstack.org/de/">Deutsch (German)</a></li>
  <li><a class="dropdown-item" href="https://docs.openstack.org/fr/">Français (French)</a></li>
  <li><a class="dropdown-item" href="https://docs.openstack.org/id/">Bahasa Indonesia (Indonesian)</a></li>
  <li><a class="dropdown-item" href="https://docs.openstack.org/it/">Italiano (Italian)</a></li>
  <li><a class="dropdown-item" href="https://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
  <li><a class="dropdown-item" href="https://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
  <li><a class="dropdown-item" href="https://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
  <li><a class="dropdown-item" href="https://docs.openstack.org/tr_TR/">Türkçe (Türkiye)</a></li>
  <li><a class="dropdown-item" href="https://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
</ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="index.html" class="docs-sidebar-section-title"><h4>python-swiftclient 0.1.0.dev1151</h4></a>
      <ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html">So You Want to Contribute…</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli/index.html">CLI</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The swiftclient.SwiftService API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#authentication">Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#available-operations">Available Operations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="client-api.html">The swiftclient.Connection API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="swiftclient.html">swiftclient</a></li>
<li class="toctree-l1"><a class="reference internal" href="swiftclient.html#module-swiftclient.authv1">swiftclient.authv1</a></li>
<li class="toctree-l1"><a class="reference internal" href="swiftclient.html#module-swiftclient.client">swiftclient.client</a></li>
<li class="toctree-l1"><a class="reference internal" href="swiftclient.html#module-swiftclient.service">swiftclient.service</a></li>
<li class="toctree-l1"><a class="reference internal" href="swiftclient.html#module-swiftclient.exceptions">swiftclient.exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="swiftclient.html#module-swiftclient.multithreading">swiftclient.multithreading</a></li>
<li class="toctree-l1"><a class="reference internal" href="swiftclient.html#module-swiftclient.utils">swiftclient.utils</a></li>
</ul>

    </div>

  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="local-table-of-contents">
      <h4 class="docs-sidebar-section-title">Page Contents</h4>
      <ul>
<li><a class="reference internal" href="#">The swiftclient.SwiftService API</a><ul>
<li><a class="reference internal" href="#authentication">Authentication</a><ul>
<li><a class="reference internal" href="#keystone-v3">Keystone V3</a></li>
<li><a class="reference internal" href="#keystone-v2">Keystone V2</a></li>
<li><a class="reference internal" href="#legacy-auth">Legacy Auth</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configuration">Configuration</a><ul>
<li><a class="reference internal" href="#options">Options</a></li>
</ul>
</li>
<li><a class="reference internal" href="#available-operations">Available Operations</a><ul>
<li><a class="reference internal" href="#stat">Stat</a></li>
<li><a class="reference internal" href="#list">List</a></li>
<li><a class="reference internal" href="#post">Post</a></li>
<li><a class="reference internal" href="#download">Download</a></li>
<li><a class="reference internal" href="#upload">Upload</a></li>
<li><a class="reference internal" href="#delete">Delete</a></li>
<li><a class="reference internal" href="#copy">Copy</a></li>
<li><a class="reference internal" href="#capabilities">Capabilities</a></li>
</ul>
</li>
</ul>
</li>
</ul>

    </div>
  </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="https://www.openstack.org/software/project-navigator/">Projects</a></li>
          <li><a href="https://security.openstack.org/">OpenStack Security</a></li>
          <li><a href="https://openstack.org/blog/">Blog</a></li>
          <li><a href="https://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="https://www.meetup.com/pro/openinfradev/">User Groups</a></li>
          <li><a href="https://openstack.org/community/events/">Events</a></li>
          <li><a href="https://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="https://openinfra.dev/members/">Companies</a></li>
          <li><a href="https://docs.openstack.org/contributors">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="https://docs.openstack.org">OpenStack Manuals</a></li>
          <li><a href="https://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="https://developer.openstack.org">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding &amp; Legal</h3>
        <ul>
          <li><a href="https://openinfra.dev/legal">Legal Docs</a></li>
          <li><a href="https://openstack.org/brand/">Logos &amp; Guidelines</a></li>
          <li><a href="https://openinfra.dev/legal/trademark-policy">Trademark Policy</a></li>
          <li><a href="https://openinfra.dev/privacy-policy">Privacy Policy</a></li>
          <li><a href="https://docs.openstack.org/contributors/common/setup-gerrit.html#individual-contributor-license-agreement">OpenInfra CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openinfradev" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/open-infrastructure-foundation" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Docs.openstack.org is powered by
          <a href="https://rackspace.com" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script src="_static/js/jquery-3.2.1.min.js"></script>

<!-- Bootstrap JavaScript -->
<script src="_static/js/bootstrap.bundle.min.js"></script>

<!-- The rest of the JS -->
<script src="_static/js/navigation.js"></script>

<!-- Docs JS -->
<script src="_static/js/docs.js"></script>

<!-- Javascript for page -->
<script>
  /* Build a description of this page including SHA, source location on git
   * repo, build time and the project's launchpad bug tag. Set the HREF of the
   * bug buttons
   */
    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
    /* "giturl" is the URL of the source file on Git and is auto-generated by
     * openstackdocstheme.
     *
     * "pagename" is a standard sphinx parameter containing the name of
     * the source file, without extension.
     */

    var sourceFile = "service-api" + ".rst";
    gitURL = "Source: https://opendev.org/openstack/python-swiftclient/src/doc/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: 139b6d714a392e943ed1dcdc4a607dedde3b185d";
    var repositoryName = "openstack/python-swiftclient";
    var bugProject = "python-swiftclient";
    var bugTitle = "The swiftclient.SwiftService API in python-swiftclient";
    var fieldTags = "";
    var useStoryboard = "";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 0.1.0.dev1151 on 2019-03-25 09:35:47";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags, repositoryName, useStoryboard);
    var currentSourceFile = "service-api";
    var pdfFileName = "doc-python-swiftclient.pdf";
    pdfLink(currentSourceFile, pdfFileName);
</script>


  </body>
</html>